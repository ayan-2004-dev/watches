<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Product Details - Watch Store</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.min.js" integrity="sha384-VQqxDN0EQCkWoxt/0vsQvZswzTHUVOImccYmSyhJTp7kGtPed0Qcx8rK9h9YEgx+" crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500&display=swap" rel="stylesheet">
</head>
<body style="background-color:#F1F3F4;">
  
<!-- Updated Navbar with proper IDs and structure -->
<nav class="navbar navbar-expand-lg m-0 p-0">
  <div class="container">
    <!-- Logo -->
    <a class="navbar-brand" href="index.html">
      <img src="assets/img/Untitled design (25)-Picsart-BackgroundRemover.png" alt="Logo" class="d-inline-block" style="width:100px; height:100px; margin: 0; padding:2px;">
    </a>
    
    <!-- Mobile Toggle Button -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" 
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <!-- Navbar Content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <!-- Main Navigation Links -->
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0 text-center">
        <li class="nav-item">
          <a class="nav-link pt-3 pb-3" href="index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link pt-3 pb-3" href="about.html">About</a>
        </li>
        <li class="nav-item">
          <a class="nav-link pt-3 pb-3" href="new_arrival.html">New Arrivals</a>
        </li>
        <li class="nav-item">
          <a class="nav-link pt-3 pb-3" href="men.html">Men Watch</a>
        </li>
        <li class="nav-item">
          <a class="nav-link pt-3 pb-3" href="women.html">Ladies Watch</a>
        </li>
        <li class="nav-item">
          <a class="nav-link pt-3 pb-3" href="contact.html">Contact Us</a>
        </li>
      </ul>
      
      <!-- Right Side: Auth Links + Cart + Orders -->
      <div class="ms-auto d-flex gap-3 align-items-center">
        
        <!-- Login/Register Button (visible when NOT logged in) -->
        <div class="auth-links" id="loginRegisterBtn">
          <a href="login.html" class="btn" style="background-color: #808080; color: white; padding: 8px 20px; border-radius: 4px; font-weight: 500; text-decoration: none; border: none; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-user"></i>
            <span>Login / Register</span>
          </a>
        </div>
        
        <!-- User Dropdown (visible when logged in) -->
        <div class="user-links" id="userDropdownMenu" style="display: none;">
          <div class="dropdown">
            <button class="btn dropdown-toggle d-flex align-items-center" type="button" id="userDropdown" 
                    data-bs-toggle="dropdown" style="background-color: #808080; color: white; padding: 8px 15px; border-radius: 4px; font-weight: 500; border: none; transition: all 0.3s ease;">
              <i class="fas fa-user-circle me-2"></i>
              <span id="userName">User</span>
            </button>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown" 
                style="border: 1px solid #808080; border-radius: 8px; padding: 10px 0; min-width: 200px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-top: 10px;">
              <li>
                <a class="dropdown-item d-flex align-items-center" href="profile.html" style="padding: 10px 15px; color: #333; text-decoration: none; transition: all 0.3s;">
                  <i class="fas fa-user me-3" style="width: 20px; text-align: center;"></i>
                  <span>My Profile</span>
                </a>
              </li>
              
              <li>
                <a class="dropdown-item d-flex align-items-center" href="order-history.html" style="padding: 10px 15px; color: #333; text-decoration: none; transition: all 0.3s;">
                  <i class="fas fa-history me-3" style="width: 20px; text-align: center;"></i>
                  <span>My Orders</span>
                </a>
              </li>
              <li>
                <div class="cart-btn-wrapper" id="cartButtonContainer" style="display: none;">
          <a href="#" class="btn cart-btn" id="mainCartBtn" 
             style="color: #070745; padding: 8px 15px; border-radius: 4px; text-decoration: none; display: flex; align-items: center; gap: 5px; position: relative;">
            <i class="bi bi-cart" style="font-size: 22px;"></i>
            <span>Cart</span>
            <span class="cart-badge" style="position: absolute; top: -5px; right: -5px; background-color: #dc3545; color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 12px; display: none; align-items: center; justify-content: center;">0</span>
          </a>
        </div>
              </li>
              <li><hr class="dropdown-divider my-2"></li>
              <li>
                <a class="dropdown-item d-flex align-items-center text-danger" href="#" id="logoutBtn" style="padding: 10px 15px; text-decoration: none; transition: all 0.3s;">
                  <i class="fas fa-sign-out-alt me-3" style="width: 20px; text-align: center;"></i>
                  <span>Logout</span>
                </a>
              </li>
            </ul>
          </div>
        </div>

        <!-- Orders Button (visible when logged in) -->
        <div class="orders-btn-wrapper" id="ordersButtonContainer" style="display: none;">
          <a href="order-history.html" class="btn daraz-orders-btn" 
             style="border: 1px solid #070745; color: #070745; padding: 8px 15px; border-radius: 4px; text-decoration: none; display: flex; align-items: center; gap: 5px;">
            <i class="fas fa-history"></i>
            <span>Orders</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</nav>

  <div class="text-scroller" style="background-color:#808080;">
    <div class="text-scroller-inner"> 
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
      <div class="text-item"><p>FREE SHIPPING - DELIVERY TIME 3-5 WORKING DAYS</p></div>
    </div>
  </div> 

  <div class="container py-5" id="productDetailsContainer">
    <!-- Product details will be loaded here -->
  </div>

  <div class="container-fluid con22">
    <div class="row r11">
      <div class="col-lg-3">
        <a class="navbar-brand" href="#">
          <img src="assets/img/Untitled design (25)-Picsart-BackgroundRemover.png" alt="Logo" class="d-inline-block" style="width:150px; height:150px; margin: 0; padding:2px;">
        </a>
      </div>
      <div class="col-lg-3">
        <p class="mt-3 text-center p5">About</p>
        <p class="" style="color:#808080;">Watch websites offer authentic, stylish, and tech-savvy timepieces for all kinds of buyers.  
          From luxury to unique designs, they blend trust, innovation, and passion for watches.</p>
      </div>
      <div class="col-lg-3">
        <p class="mt-3 text-center p5">Pages</p>
        <ul class="ul1">
          <li class="text-center"><a href="index.html">Home</a></li>
          <li class="text-center"><a href="about.html">About</a></li>
          <li class="text-center"><a href="new_arrival.html">New Arrival</a></li>
          <li class="text-center"><a href="men.html">Men</a></li>
          <li class="text-center"><a href="women.html">Women</a></li>
          <li class="text-center"><a href="#">Contact</a></li>
        </ul>
      </div>
      <div class="col-lg-3">
        <h5 class="ms-4 mb-4 p5 mt-3 text">Contact</h5>
        <p class="mb-4 ms-3" style="color: #808080;">+92-314-0132-156</p>
        <div class="links">
          <a href=""><i class="fa-brands fa-facebook"></i></a>
          <a href=""><i class="fa-brands fa-instagram"></i></a>
          <a href=""><i class="fa-brands fa-twitter"></i></a>
          <a href=""><i class="fa-brands fa-youtube"></i></a>
        </div>
      </div>
    </div>
  </div>

  <script src="assets/js/auth.js"></script>
  <script src="assets/js/cart.js"></script>
  <script src="assets/js/checkout.js"></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Get product ID from URL
      const urlParams = new URLSearchParams(window.location.search);
      const productId = parseInt(urlParams.get('id'));
      
      if (!productId) {
        document.getElementById('productDetailsContainer').innerHTML = 
          '<div class="alert alert-danger">Product not found!</div>';
        return;
      }

      // Fetch product data
      fetch('data.json')
        .then(res => res.json())
        .then(products => {
          const product = products.find(p => p.id === productId);
          
          if (!product) {
            document.getElementById('productDetailsContainer').innerHTML = 
              '<div class="alert alert-danger">Product not found!</div>';
            return;
          }

          // Create product details HTML
          const productHTML = `
            <div class="row justify-content-center align-items-center g-4">
              <div class="col-lg-6 d-flex justify-content-center">
                <div id="productCarousel" class="carousel slide" data-bs-ride="carousel">
                  <div class="carousel-inner">
                    <div class="carousel-item active">
                      <img src="assets/imgs2/${product.img}" class="img-fluid d-block mx-auto" 
                           alt="${product.watch_name}" style="max-height: 500px; object-fit: contain;">
                    </div>
                    <div class="carousel-item">
                      <img src="assets/imgs2/${product.img1}" class="img-fluid d-block mx-auto" 
                           alt="${product.watch_name}" style="max-height: 500px; object-fit: contain;">
                    </div>
                  </div>
                  <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" style="background-color: #808080;"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" style="background-color: #808080;"></span>
                    <span class="visually-hidden">Next</span>
                  </button>
                </div>
              </div>
              
              <div class="col-lg-6">
                <h1 class="producth1 mb-3">${product.watch_name}</h1>
                <h3 class="producth4 mb-4">Rs ${product.watch_price.toLocaleString()}</h3>
                
                <div class="mb-4">
                  <h5 class="h66 mb-3">Description</h5>
                  <p class="text-muted">${product.dis || 'Premium quality watch with elegant design.'}</p>
                </div>
                
                <div class="mb-4">
                  <h6 class="h66 mb-2">Ratings</h6>
                  <div class="icon11 mb-3">
                    <i class="fas fa-star text-warning"></i>
                    <i class="fas fa-star text-warning"></i>
                    <i class="fas fa-star text-warning"></i>
                    <i class="fas fa-star text-warning"></i>
                    <i class="fas fa-star-half-alt text-warning"></i>
                    <span class="ms-2">(4.5/5.0)</span>
                  </div>
                </div>
                
                <div class="mb-4">
                  <div class="row align-items-center">
                    <div class="col-auto">
                      <label for="quantity" class="form-label h66 mb-0">Quantity:</label>
                    </div>
                    <div class="col-auto">
                      <div class="input-group" style="width: 150px;">
                        <button class="btn btn-outline-secondary" type="button" id="decreaseQty">-</button>
                        <input type="number" class="form-control text-center" id="quantity" 
                               value="1" min="1" max="10">
                        <button class="btn btn-outline-secondary" type="button" id="increaseQty">+</button>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="btnn11 mb-5">
                  <button class="btn btn-dark btn-lg w-100 py-3 add-to-cart-btn" 
                          id="addToCartBtn" 
                          data-product-id="${productId}"
                          style="background-color: #808080; border: none;">
                    <i class="fas fa-cart-plus me-2"></i>Add to Cart
                  </button>
                </div>
                
                <!-- Specifications Accordion -->
                <div class="accordion mb-4" id="specsAccordion">
                  <div class="accordion-item">
                    <h2 class="accordion-header">
                      <button class="accordion-button collapsed" type="button" 
                              data-bs-toggle="collapse" data-bs-target="#specsCollapse" 
                              style="color: #808080; font-weight: bold;">
                        <i class="fas fa-info-circle me-2"></i>Specifications
                      </button>
                    </h2>
                    <div id="specsCollapse" class="accordion-collapse collapse" 
                         data-bs-parent="#specsAccordion">
                      <div class="accordion-body">
                        <ul class="list-unstyled">
                          ${product.spec ? `<li><strong>${product.spec}</strong></li>` : ''}
                          ${product.spec1 ? `<li>${product.spec1}</li>` : ''}
                          ${product.spec2 ? `<li>${product.spec2}</li>` : ''}
                          ${product.spec3 ? `<li>${product.spec3}</li>` : ''}
                          ${product.spec4 ? `<li>${product.spec4}</li>` : ''}
                          <li>Water Resistant: 50M</li>
                          <li>Warranty: 2 Years International</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  
                  <div class="accordion-item">
                    <h2 class="accordion-header">
                      <button class="accordion-button collapsed" type="button" 
                              data-bs-toggle="collapse" data-bs-target="#featuresCollapse" 
                              style="color: #808080; font-weight: bold;">
                        <i class="fas fa-star me-2"></i>Features
                      </button>
                    </h2>
                    <div id="featuresCollapse" class="accordion-collapse collapse" 
                         data-bs-parent="#specsAccordion">
                      <div class="accordion-body">
                        <ul class="list-unstyled">
                          <li><i class="fas fa-check text-success me-2"></i>Premium Stainless Steel Case</li>
                          <li><i class="fas fa-check text-success me-2"></i>Scratch-Resistant Crystal</li>
                          <li><i class="fas fa-check text-success me-2"></i>Japanese Quartz Movement</li>
                          <li><i class="fas fa-check text-success me-2"></i>Genuine Leather Strap</li>
                          <li><i class="fas fa-check text-success me-2"></i>Luminous Hands & Markers</li>
                          <li><i class="fas fa-check text-success me-2"></i>Date Display Function</li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          `;

          document.getElementById('productDetailsContainer').innerHTML = productHTML;

          // Quantity controls
          const quantityInput = document.getElementById('quantity');
          const decreaseBtn = document.getElementById('decreaseQty');
          const increaseBtn = document.getElementById('increaseQty');
          const addToCartBtn = document.getElementById('addToCartBtn');

          // Quantity decrease
          decreaseBtn.addEventListener('click', () => {
            let value = parseInt(quantityInput.value);
            if (value > 1) {
              quantityInput.value = value - 1;
            }
          });

          // Quantity increase
          increaseBtn.addEventListener('click', () => {
            let value = parseInt(quantityInput.value);
            if (value < 10) {
              quantityInput.value = value + 1;
            }
          });

          // Add to cart button functionality - Now uses auth system for login check
          addToCartBtn.addEventListener('click', function(e) {
            e.preventDefault();
            
            // Check if user is logged in using auth system
            if (!window.authSystem || !window.authSystem.isLoggedIn()) {
              // Show login modal
              if (window.authSystem) {
                window.authSystem.showLoginRequired();
              } else {
                // Fallback if auth system not loaded
                window.location.href = 'login.html';
              }
              return;
            }
            
            // If logged in, proceed with adding to cart
            const quantity = parseInt(quantityInput.value);
            
            if (window.cartSystem && typeof window.cartSystem.addToCart === 'function') {
              const productData = {
                id: product.id,
                name: product.watch_name,
                price: product.watch_price,
                img: product.img,
                quantity: quantity
              };
              
              const result = window.cartSystem.addToCart(productData);
              
              // Update button text temporarily
              const originalText = addToCartBtn.innerHTML;
              addToCartBtn.innerHTML = result === 'added' 
                ? '<i class="fas fa-check me-2"></i>Added to Cart!' 
                : '<i class="fas fa-check me-2"></i>Cart Updated!';
              addToCartBtn.classList.add('btn-success');
              addToCartBtn.classList.remove('btn-dark');
              
              // Show cart modal
              setTimeout(() => {
                window.cartSystem.showCartModal();
              }, 500);
              
              // Reset button after 2 seconds
              setTimeout(() => {
                addToCartBtn.innerHTML = originalText;
                addToCartBtn.classList.remove('btn-success');
                addToCartBtn.classList.add('btn-dark');
              }, 2000);
            } else {
              // Fallback if cart system not loaded
              alert('Cart system not loaded. Please refresh the page.');
            }
          });

          // Make sure quantity input stays valid
          quantityInput.addEventListener('change', function() {
            let value = parseInt(this.value);
            if (value < 1) this.value = 1;
            if (value > 10) this.value = 10;
          });

        })
        .catch(error => {
          console.error('Error loading product:', error);
          document.getElementById('productDetailsContainer').innerHTML = 
            '<div class="alert alert-danger">Error loading product details. Please try again.</div>';
        });
    });
  </script>

  <!-- Custom CSS for this page -->
  <style>
    .producth1 {
      color: #808080;
      font-weight: 700;
      font-size: 3.5rem;
      font-family: 'Allison', cursive;
    }
    
    .producth4 {
      color: #808080 !important;
      font-size: 2rem !important;
      font-weight: 700 !important;
    }
    
    .h66 {
      color: #666;
      font-weight: 600;
    }
    
    .icon11 i {
      color: goldenrod;
      font-size: 1.2rem;
    }
    
    .btnn11 button {
      transition: all 0.3s ease;
    }
    
    .btnn11 button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    
    .accordion-button:not(.collapsed) {
      background-color: #f8f9fa;
      color: #808080;
    }
    
    .accordion-button:focus {
      box-shadow: none;
      border-color: rgba(0,0,0,.125);
    }
    
    .carousel-control-prev-icon,
    .carousel-control-next-icon {
      background-color: #808080;
      border-radius: 50%;
      padding: 15px;
    }
    
    .input-group button {
      background-color: #808080;
      color: white;
      border: none;
    }
    
    .input-group button:hover {
      background-color: #666;
    }
    
    #quantity {
      border-color: #808080;
    }
    
    .btn-success {
      background-color: #28a745 !important;
    }
  </style>

</body>
</html>